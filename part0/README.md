# Parte 0: Fundamentos de las aplicaciones Web

_En esta parte se desarrollar√°n los conceptos basicos del desarrollo web y se hablar√° de como evolucion√≥ el desarrollo de aplicaciones web en las √∫ltimas d√©cadas._

1. [Fundamentos de las aplicaciones Web](#-fundamentos-de-las-aplicaciones-web-)
    * [HTTP GET](#-http-get-)
    * [Aplicaciones web tradicionales](#-aplicaciones-web-tradicionales-)
    * [La l√≥gica de la aplicaci√≥n corriendo en el navegador](#-la-l√≥gica-de-la-aplicaci√≥n-corriendo-en-el-navegador-)
    * [Control de eventos y funciones Callback](#-control-de-eventos-y-funciones-callback-)
    * [DOM o Modelo de Objetos del Documento](#-dom-o-modelo-de-objetos-del-documento-)
    * [Manipulando el Document-Object desde la consola](#-manipulando-el-document-object-desde-la-consola-)
    * [CSS](#-css-)
    * [Cargando una p√°gina que contiene JavaScript](#-cargando-una-p√°gina-que-contiene-javascript)
    * [Formularios y HTTP POST](#-formularios-y-http-post-)
    * [AJAX](#-ajax-)
    * [SPA o aplicaci√≥n de una p√°gina](#-spa-o-aplicaci√≥n-de-una-p√°gina-)
    * [Librer√≠as de JavaScript](#-librer√≠as-de-javascript-)
    * [Desarrollo web full stack](#-desarrollo-web-full-stack-)



## üîπüîπüîπ Fundamentos de las aplicaciones Web üîπüîπüîπ

_A continuaci√≥n podremos observar unas im√°genes que servir√°n para demostrar conceptos b√°sicos pero que no quieren decir que sean ejemplos de como las aplicaciones Web deben ser. Por el contrario, muestran viejas tecnicas de desarrollo web que pueden considerarse_ **malas pr√°cticas** _hoy en d√≠a._

_Durante todo el curso se estar√° utilizando el navegador Chrome._

**_La primera regla del desarrollo Web:_** _Siempre tener a la vista la Consola de Desarrollo abierta en tu navegador. En macOS, la consola se abre presionando `F12` o `option-cmd-i` simultaneamente. En Windows o Linux, la consola se abre presionando `F12` o `ctrl-shift-i` simultaneamente._

_La consola se ve de la siguiente manera:_

![consola](./img/1e.png)

_Es recomendable,en la pesta√±a Network, tener marcada la opcion de deshabilitar el cache (Disable cache) como se muestra en la imagen, ya que de no hacerlo es muy probable que no veamos los cambios que realicemos a nuestro c√≥digo. Preservar el log (Preserve log) puede ser muy util ya que guarda los logs ya mostrados por la aplicacion cuando la p√°gina es recargada._

**Nota:** _La pesta√±a mas importante es la **Consola**. Sin embargo, en esta introducci√≥n se estar√° utilizando bastante la pesta√±a **Network**._



### üîπüîπüîπ HTTP GET üîπüîπüîπ

_El servidor y el navegador web se comunican uno con el otro mediante el protocolo [HTTP](https://developer.mozilla.org/en-US/docs/Web/HTTP). La pesta√±a Network muestra como se comunican el navegador y el servidor._

_Cuando la pagina es recargada (presionando `F5` o en el simbolo ‚Ü∫ del navegador), la consola muestra que dos eventos han sucedido:_

* _El navegador recupera (fetch) el contenido de la pagina fullstack-exampleapp.herokuapp.com del servidor._

* _Y descarga la imagen kuva.png_

![fetches](./img/2e.png)

_En una pantalla peque√±a puede que se deba ampliar la ventana de la consola para verlo._

_Clickeando en el primer evento har√° que se nos muestre mas informacio√≥n sobre lo que est√° sucediendo:_

![event](./img/3e.png)

_La parte de arriba, General, muestra que el navegador hizo una petici√≥n (request) a la direcci√≥n `https://fullstack-exampleapp.herokuapp.com` usando el m√©todo GET, y que la petici√≥n fue exitosa, porque la respuesta del servidor tiene un [Status code](https://en.wikipedia.org/wiki/List_of_HTTP_status_codes) **200**._

_La petici√≥n y la respuesta del servidor tiene varios encabezados (headers):_

![headers](./img/4e.png)

_Los response headers (encabezados de la respuesta) nos dicen, por ejemplo, el tama√±o de la respuesta en bytes, y el tiempo exacto de la respuesta. Un encabezado importante es el [Content-Type](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type) que nos dice que la respuesta es un archivo de texto en formato [utf-8](https://en.wikipedia.org/wiki/UTF-8), cuyo contenido ha sido formateado en HTML. De esta manera el navegador sabe que la respuesta es una pagina [HTML](https://en.wikipedia.org/wiki/HTML), y que debe renderizarlo en el navegador 'como una pagina web'._

_La pesta√±a Response (respuesta) muestra los datos de la respuesta, una p√°gina HTML normal. La secci√≥n **body** determina la estructura de la p√°gina renderizada en la pantalla:_

![headers](./img/5e.png)

_La p√°gina contiene un elemento [div](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/div), que dentro contiene un heading (encabezado), un link a una p√°gina notes, y una etiqueta [img](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img), y muestra el n√∫mero de notas creadas._

_Debido a la etiqueta img, el navegador realiza una segunda petici√≥n HTTP para recuperar la imagen kuva.png de el servidor. El detalle de la petici√≥n es el siguiente:_

![img etiqueta](./img/6e.png)

_La petici√≥n se realiz√≥ a la direcci√≥n `https://fullstack-exampleapp.herokuapp.com/kuva.png` y su tipo es HTTP GET. El encabezado de la respuesta nos dice que el tama√±o de la respuesta es de 89350 bytes, y su [Content-Type](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type) es image/png, asi que es una imagen png. El navegador usa esta informaci√≥n para renderizar la imagen correctamente en la pantalla._

_La cadena de eventos causada por abrir la p√°gina `https://fullstack-exampleapp.herokuapp.com` en el navegador genera el siguiente [diagrama de secuencia](https://www.geeksforgeeks.org/unified-modeling-language-uml-sequence-diagrams/):_

![secuence diagram](./img/7e.png)

_Primero, el navegador hace una solicitud HTTP GET al servidor para recuperar el codigo HTML de la pagina. La etiqueta img en el HMTL le indica al navegador que debe recuperar la imagen kuva.png. El navegador renderiza la pagina HTML y la imagen en la pantalla._

_Aunque es dificil de notar, la p√°gina HTML comienza a renderizarse antes de que la imagen sea recuperada del servidor._



### üîπüîπüîπ Aplicaciones web tradicionales üîπüîπüîπ

_La p√°gina de inicio de la aplicacion de ejemplo funciona como una aplicacion web tradicional. Cuando uno entra a la p√°gina, el navegador recupera el documento HTML detallando la estructura y el contenido textual de la p√°gina desde el servidor._

_El servidor ha formateado el documento de alguna manera. El documento puede ser una archivo de texto guardado en el directorio del servidor. El servidor tambien puede formar el documento HTML **dinamicamente** seg√∫n el codigo de la aplicaci√≥n, utilizando por ejemplo, datos de una base de datos. El codigo HTML de la aplicaci√≥n de ejemplo ha sido formado dinamicamente, porque este contiene informacion sobre el n√∫mero de notas creadas._

_El codigo HTML de la pagina de inicio es el siguiente:_

~~~
const getFrontPageHtml = (noteCount) => {
  return(`
    <!DOCTYPE html>
    <html>
      <head>
      </head>
      <body>
        <div class='container'>
          <h1>Full stack example app</h1>
          <p>number of notes created ${noteCount}</p>
          <a href='/notes'>notes</a>
          <img src='kuva.png' width='200' />
        </div>
      </body>
    </html>
`)
} 

app.get('/', (req, res) => {
  const page = getFrontPageHtml(notes.length)
  res.send(page)
})
~~~

_No es necesario entender el c√≥digo todav√≠a._

_El contenido de la p√°gina HTML ha sido guardado como un **template string**, o un string (cadena de texto) que permite, por ejemplo, evaluar variables dentro de ella. La parte de la p√°gina de inicio que cambia din√°micamente, el n√∫mero de notas guardadas (en el c√≥digo `noteCount`), es remplazado por el n√∫mero actual de notas (en el c√≥digo `notes.length`) en el template string._

_En una aplicaci√≥n web tradicional el navegador es un poco "tonto". Solo recupera el HTML del servidor, y toda la l√≥gica de la aplicaci√≥n esta en el servidor. Un servidor puede ser creado, por ejemplo, usando Java Spring, Python Flask o con Ruby on Rails._

_En este curso se utilizar√° Node.js y su framework Express para crear un servidor web._



### üîπüîπüîπ La l√≥gica de la aplicaci√≥n corriendo en el navegador üîπüîπüîπ

_La siguiente imagen corresponde a la p√°gina notes, el navegador realiza cuatro solicitudes HTTP:_

![pagina notes](./img/8e.png)

_Todas las solicitudes tienen **diferentes tipos**. El tipo de la primer solicitud es **document**. Es el codigo HTML de la pagina, y se ve de la siguiente manera:_

![first request](./img/9e.png)

_Cuando comparamos la p√°gina mostrada en el navegador y el c√≥digo HTML devuelto por el servidor, notamos que el codigo no contiene la lista de notas. La secci√≥n [head](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/head) contiene una etiqueta [script](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/script), que hace que el navegador recupere un archivo JavaScript llamado main.js._

_El c√≥digo JavaScript se ve de la siguiente manera:_

~~~
var xhttp = new XMLHttpRequest()

xhttp.onreadystatechange = function() {
  if (this.readyState == 4 && this.status == 200) {
    const data = JSON.parse(this.responseText)
    console.log(data)

    var ul = document.createElement('ul')
    ul.setAttribute('class', 'notes')

    data.forEach(function(note) {
      var li = document.createElement('li')

      ul.appendChild(li)
      li.appendChild(document.createTextNode(note.content))
    })

    document.getElementById('notes').appendChild(ul)
  }
}

xhttp.open('GET', '/data.json', true)
xhttp.send()
~~~

_Los detalles del codigo no son importantes ahora, pero se agreg√≥ algo de codigo para darle vida a las imagenes y al texto. En la [parte 1]() se empezar√° a escribir codigo apropiadamente. El c√≥digo de ejemplo utilizado en esta parte actualmente no es relevante para las tecnicas de desarrollo de este curso._

>_Algunos podr√≠an perguntarse porque se utiliza el objeto xhttp en lugar del fetch moderno. Esto se debe a que no queremos introducirnos en promesas por el momento, y el c√≥digo tiene un rol secundario en esta parte. En la [parte 2]() volveremos a la manera moderna de realizar solicitudes al servidor._<

_Inmediatamente despu√©s de recuperar la etiqueta **script**, el navegador ejecuta el c√≥digo._

_Las √∫ltimas dos lineas definen que el navegador hace una solicitud HTTP GET a la direcci√≥n del servidor /data.json:_

~~~
xhttp.open('GET', '/data.json', true)
xhttp.send()
~~~

_Esta es la solicitud es la mostrada al final de la lista en la pesta√±a Network._

![data.json](./img/10e.png)

_Ac√° encontramos las notas en JSON como datos sin procesar. Por defecto, el navegador no es bueno mostrando datos JSON. Se puede utilizar plugins para manejar el formateo. Se puede instalar, por ejemplo, [JSONView](https://chrome.google.com/webstore/detail/jsonview/chklaanhfefbnpoihckbnefhakgolnmc) en Chrome, y al recargar la p√°gina, los datos se mostrar√°n bien formateados:_

![formatted json](./img/11e.png)

_As√≠, el c√≥digo JavaScript de la p√°gina anterior de notas descarga los datos JSON que contienen las notas, y genera una lista a partir del contenido de la nota._

_Esto est√° hecho por el siguiente c√≥digo:_

~~~
const data = JSON.parse(this.responseText)
console.log(data)

var ul = document.createElement('ul')
ul.setAttribute('class', 'notes')

data.forEach(function(note) {
  var li = document.createElement('li')

  ul.appendChild(li)
  li.appendChild(document.createTextNode(note.content))
})

document.getElementById('notes').appendChild(ul)
~~~

_El c√≥digo primero crea una lista no ordenada con la etiqueta [ul](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/ul)..._

~~~
var ul = document.createElement('ul')
ul.setAttribute('class', 'notes')
~~~

_...y luego cada nota es agregada a una etiqueta [li](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/li). Solo el valor **content** de cada nota se convierte en el contenido de la etiqueta li. Los datos de las fechas no son utilizados en ning√∫n lugar aqu√≠._

~~~
data.forEach(function(note) {
  var li = document.createElement('li')

  ul.appendChild(li)
  li.appendChild(document.createTextNode(note.content))
})
~~~

_Ahora abrimos la pesta√±a Console en la consola de desarrollo:_

![console](./img/12e.png)

_Clickeando en el peque√±o tri√°ngulo al comienzo de la linea, se puede expandir el texto en al consola._

![expand console](./img/13e.png)

_La salida de la consola es causada por el comando `console.log` en el c√≥digo:_

~~~
const data = JSON.parse(this.responseText)
console.log(data)
~~~

_As√≠, cuando se reciben los datos del servidor, el c√≥digo lo muestra en la consola._

_La pesta√±a Console y el comando `console.log` se convertiran en algo muy familiar durante el curso._



### üîπüîπüîπ Control de eventos y funciones Callback üîπüîπüîπ

_La estructura de este c√≥digo es un poco extra√±a:_

~~~
var xhttp = new XMLHttpRequest()

xhttp.onreadystatechange = function() {
  // el c√≥digo dentro de esta funcion 
  // se encarga de la respuesta del servidor
}

xhttp.open('GET', '/data.json', true)
xhttp.send()
~~~

_La petici√≥n al servidor es enviada en la ultima linea, pero el c√≥digo que maneja la respuesta se encuentra m√°s arriba. Qu√© est√° pasando?_

~~~
xhttp.onreadystatechange = function () {
~~~

_En esta linea, un controlador de eventos (event handler) **onreadystatechange** es definido para el objeto `xhttp` haciendo la petici√≥n. Cuando el estado del objeto cambia, el navegador llama a la funcion controladora de eventos. El codigo de la funci√≥n verifica que el [`readyState`](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/readyState) sea igual a 4 (que significa que **la operaci√≥n esta completada**) y que el codigo de estado HTTP (status code) de la respuesta es **200**._

~~~
xhttp.onreadystatechange = function() {
  if (this.readyState == 4 && this.status == 200) {
    // el c√≥digo dentro de esta funcion 
    // se encarga de la respuesta del servidor
  }
}  
~~~

_Esta forma de llamar a los controladores de eventos en JavaScript es muy com√∫n. Las funciones controladoras de eventos (event handler functions) son llamadas funciones de [Callback](https://developer.mozilla.org/en-US/docs/Glossary/Callback_function). El codigo de la aplicaci√≥n no llama por si mismo a la funci√≥n, sino que lo hace el entorno de ejecuci√≥n (runtime enviroment), que en este caso seria el navegador. Asi, cada vez que ocurre el evento, el navegador llama a la funci√≥n en el momento apropiado._



### üîπüîπüîπ DOM o Modelo de Objetos del Documento üîπüîπüîπ

_Podemos pensar a las p√°ginas HTML como estructuras de √°rbol._

~~~
html
  head
    link
    script
  body
    div
      h1
      div
        ul
          li
          li
          li
      form
        input
        input
~~~

_Esta misma estructura puede verse en la pesta√±a de la consola **Elements**._

![elements console](./img/14e.png)

_Asi, el funcionamiento del navegador esta basado en la idea de representar los elementos HTML como un √°rbol._

_El DOM es una Interfaz de Programaci√≥n de Aplicaciones (mas conocida como API), que permite la modificaci√≥n de los elementos del √°rbol correspondientes a las p√°ginas webs a trav√©s de la programaci√≥n._

_El codigo JavaScript introducido previamente en este cap√≠tulo usa la DOM-API para agregar la lista de notas a la p√°gina._

_El siguiente c√≥digo crea un nuevo nodo en la variable `ul`, y agrega algunos nodos hijos a √©l:_

~~~
var ul = document.createElement('ul')

data.forEach(function(note) {
  var li = document.createElement('li')

  ul.appendChild(li)
  li.appendChild(document.createTextNode(note.content))
})
~~~

_Por √∫ltimo, la rama del √°rbol de la variable `ul` es colocada en el lugar apropiado en el √°rbol del HTML de toda la p√°gina:_

~~~
document.getElementById('notes').appendChild(ul)
~~~

### üîπüîπüîπ Manipulando el Document-Object desde la consola üîπüîπüîπ

_El nodo principal del DOM del cual derivan el resto de nodos en un documento HTML es llamado `document` object (objeto document). Podemos realizar varias operaciones en una pagina web usando la DOM-API. Podemos acceder al objeto `document` desde la pesta√±a Console:_

![document object](./img/15e.png)

_Vamos a agregar una nueva nota a la p√°gina desde la consola._

_Primero debemos obtener la lista de notas de la p√°gina. La lista est√° en el primer elemento `ul` de la p√°gina:_

~~~
list = document.getElementsByTagName('ul')[0]
~~~

_Luego creamos un nuevo elemento `li` y le agregamos algun texto con el metodo de elementos `textContent`:_

~~~
newElement = document.createElement('li')
newElement.textContent = 'Page manipulation from console is easy'
~~~

_Y finalmente agregamos el nuevo elemento li a la lista:_

~~~
list.appendChild(newElement)
~~~

![element added](./img/16e.png)

_Hay que aclarar que aunque la p√°gina se actualiza en el navegador con el nuevo elemento, el cambio no es permanente. Si la pagina es recargada, la nueva nota que agregamos a trav√©s de la consola desaparecer√° debido a que los cambios no son hechos en el servidor sino en el navegador._



### üîπüîπüîπ CSS üîπüîπüîπ

_El elemento **head** de el c√≥digo HTML de la pagina de Notas contiene una etiqueta [link](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link), que le dice al navegador que debe recuperar un archivo de estilos CSS de la direcci√≥n main.css._

_CSS (Cascading Style Sheets) que significa hojas de estilo en cascada, es un lenguaje de markup usado para determinar la apariencia de las p√°ginas web._

_El archivo CSS recuperado se ve de la siguiente manera:_

~~~
.container {
  padding: 10px;
  border: 1px solid; 
}

.notes {
  color: blue;
}
~~~

_El archivo define dos [selectores de clase](https://developer.mozilla.org/en-US/docs/Web/CSS/Class_selectors). Estos son utilizados para seleccionar ciertas partes de la p√°gina y definir sus reglas de estilo para cambiar su apariencia._

_Las **clases** son [atributos](https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/class), que pueden agregarse a los elementos HTML._

_Los atributos CSS pueden examinarse en la pesta√±a Elements de la consola:_

![css elements tab console](./img/17e.png)

_El elemento **div** mas externo tiene la clase **container**. El elemento **ul** que contiene la lista de notas tiene la clase **notes**._

_Las reglas de CSS definen que el elemento que tenga la clase container ser√° delineado con un borde de un pixel de grosor. Este tambien tendr√° un padding de 10 pixel que agrega un espacio vacio entre el contenido del elemento y el borde._

_La segunda regla de CSS nombrada como **notes** configura el color del texto en azul._

_Los elementos HTML tambien pueden tener otro atributos aparte de las clases. El elemento **div** que contiene las notas tiene un atributo [id](https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/id). El c√≥digo JavaScript usa el atributo id para encontrar **un** elemento._

_La pesta√±a Elements de la consola puede ser usada para cambiar los estilos de los elementos._

![changing css](./img/18e.png)

_Los cambios hechos en la consola no son permantes. Al igual que con los cambios en el DOM, si se quiere que los cambios de estilo sean permanentes deben ser guardados en el servidor._


### üîπüîπüîπ Cargando una p√°gina que contiene JavaScript üîπüîπüîπ

_Cuando abrimos en el navegador una p√°gina como la de notas que contiene JavaScript, el diagrama de secuencia es el siguiente:_

![secuence diagram js](./img/19e.png)

* _El navegador recupera el c√≥digo HTML que define el contenido y la estructura de la p√°gina desde el servidor utilizando una solicitud HTTP GET._
* _Los links en el c√≥digo HTML hacen que el navegador tambi√©n recupere las hojas de estilo CSS, en este caso, main.css._
* _Y tambi√©n el archivo de c√≥digo JavaScript main.js._
* _El navegador ejecuta el c√≥digo JavaScript. El c√≥digo hace una petici√≥n HTTP GET a la direcci√≥n `https://fullstack-exampleapp.herokuapp.com/data.json` que retorna las notas como datos JSON._
* _Una vez que los datos han sido recuperados, el navegador ejecuta el controlador de eventos, que renderiza las notas en la p√°gina utilizando la DOM-API._



### üîπüîπüîπ Formularios y HTTP POST üîπüîπüîπ

_A continuaci√≥n veremos como se agrega una nueva nota a la lista._

_La p√°gina notas contiene un elemento [form](https://developer.mozilla.org/en-US/docs/Learn/HTML/Forms/Your_first_HTML_form)._

![form element](./img/20e.png)

_Cuando el bot√≥n del formulario es presionado, el navegador enviar√° la entrada del usuario al servidor. Veamos como se ve el envio del formulario en la pesta√±a Network:_

![form submit network tab](./img/21e.png)

_Enviar el formulario causa **cinco** peticiones HTTP. La primera equivale al evento de enviar el formulario. Vemamos que muestra:_

![form submit headers](./img/22e.png)

_Esta es una peticion HTTP POST realizada a la direccion del servidor `/new_note`. El servidor responde con un HTTP status code 302, que significa **encontrado**. Esto es una [redirecci√≥n a un URL](https://en.wikipedia.org/wiki/URL_redirection), con la cual el servidor le solicita al navegador que realice una solicitud HTTP GET a la direcci√≥n que esta definida en los headers de la respuesta: `Location: /notes`_

_As√≠, el navegador recarga la p√°gina Notes. La recarga genera tres solicitudes HTTP m√°s: La de recuperar la hoja de estilos (main.css), la del codigo JavaScript, y la de los datos en crudo de las notas (data.json)._

_La pesta√±a Network tambi√©n muestra la informaci√≥n enviada en el formulario:_

![form submit data](./img/23e.png)

_La etiqueta Form tiene como atributos **action** y **method**, que definen que el envio del formulario debe hacerse como una petici√≥n POST a la direcci√≥n `/new_notes`._

![form attr](./img/24e.png)

_El c√≥digo en el servidor que responde a la petici√≥n POST es bastante simple (Nota: Este c√≥digo esta en el servidor y no en el c√≥digo JavaScript recuperado por el navegador):_

~~~
app.post('/new_note', (req, res) => {
  notes.push({
    content: req.body.note,
    date: new Date(),
  })

  return res.redirect('/notes')
})
~~~

_Los datos son enviados en el [body](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/POST)(cuerpo) de la petici√≥n POST._

_El servidor puede acceder a los datos accediendo al campo `req.body` del objeto de la solicitud `req`._

_El servidor crea un objeto para la nueva nota, y lo agrega al array llamado `notes`._

~~~
notes.push({
  content: req.body.note,
  date: new Date(),
})
~~~

_El objeto Note tiene dos campos: **content** que contiene el contenido actual de la nota, y **date** que contiene la fecha y la hora en la cual la nota fue creada._

_El servidor no graba la nueva nota en una base de datos, solamente se guarda en espacio de memoria, por lo que al reiniciar el servidor las nuevas notas agregadas desaparecer√°n._



### üîπüîπüîπ AJAX üîπüîπüîπ

_La p√°gina Notas de la aplicaci√≥n sigue un estilo noventoso de desarrollo web y "utiliza AJAX". Como tal, estuvo en la cresta de la ola de la tecnolog√≠a web de principios de los 2000._

_AJAX (Asynchronous JavaScript and XML), o JavaScript y XML as√≠ncrono, es un termino introducido en febrero del 2005 gracias a los avances en las tecnolog√≠as de los navegadores para describir un nuevo enfoque revolucionario que permiti√≥ la b√∫squeda de contenido en p√°ginas web utilizando JavaScript incluido dentro del HTML, sin la necesidad de volver a recargar la p√°gina._

_Antes de esto, todas las p√°ginas funcionaban como la aplicaci√≥n web tradicional vista anteriormente en este cap√≠tulo. Todos los datos que se muestran en la p√°gina se obtuvieron con el c√≥digo HTML generado por el servidor._

_La pagina Notas utiliza AJAX para recuperar los datos de las notas. El envio del formulario utiliza el mecanismo tradicional._

_Las URLs de la aplicaci√≥n son un claro reflejo de los viejos tiempos sin preocupaciones. Los datos JSON son recuperados directamente de la url `https://fullstack-exampleapp.herokuapp.com/data.json` y las nuevas notas son enviadas a la URL `https://fullstack-exampleapp.herokuapp.com/new_note`._
_Hoy en dia URLs como estas no son concideradas aceptables, ya que no siguen las conveciones de las APIs [RESTful](https://en.wikipedia.org/wiki/Representational_state_transfer#Applied_to_Web_services), que se veran en profundidad en la parte 3._

_Lo que se denomina AJAX ahora es tan com√∫n que se da por sentado, y as√≠ el termino se desvanecio en el olvido y la nueva generaci√≥n ni siquiera escuch√≥ hablar de esto._



### üîπüîπüîπ SPA o aplicaci√≥n de una p√°gina üîπüîπüîπ

_En la app de ejemplo, la p√°gina de inicio trabaja como una p√°gina web tradicional: Toda la l√≥gica esta en el servidor, y el navegador solo renderiza el HTML como se le indica._

_La p√°gina de notas le da algo de responsabilidad al navegador al generar el codigo HTML para cada nota existente. Esta tarea la realiza ejecutando el c√≥digo JavaScript que obtuvo del servidor. El c√≥digo recupera las notas del servidor como datos JSON y agrega elementos HTML para mostrar las notas en la p√°gina utilizando la [DOM-API](#-dom-o-modelo-de-objetos-del-documento-)._

_En los √∫ltimos a√±os ha surgido el estilo de aplicaciones de una sola p√°gina (SPA) para crear aplicaciones web. Los sitios web de estilo SPA no  obtienen todas sus paginas por separado del servidor como lo hace la aplicacion de muestra vista anteriormente, sino que consisten en una p√°gina HTML obtenida del servidor, cuyo contenido se manipula con JavaScript que se ejecuta en el navegador (√©sta pagina HTML le indica al navegar que debe obtener √©ste codigo JavaScript que va a manipular la p√°gina)._

_La p√°gina de Notas de la aplicaci√≥n vista tiene algo de parecido con las aplicaciones de estilo SPA, pero todavia no esta del todo lista. Aunque la l√≥gica para renderizar las notas esta corriendo en el navegador, la p√°gina todavia usa la manera tradicional de agregar las notas nuevas. Los datos son enviados al servidor con un submit (envio) del formulario, y el servidor le dice al navegador que recargue la p√°gina Notas con un redireccionamiento._

_Vamos un ejemplo de como ser√≠a una versi√≥n SPA de la aplicaci√≥n de ejemplo. A primera vista, la aplicaci√≥n se ve exactamente como la anterior. El codigo HTML es casi id√©ntico, pero el archivo JavaScript es diferente (spa.js) y hay un peque√±o cambio in como la etiqueta **form** es definida:_

![spa form](./img/25e.png)

_El formulario no tiene atributos **action** o **method** para definir como y a d√≥nde son enviados los datos ingresados._

_S√≠ abrimos la pesta√±a Network, la limpiamos con el s√≠mbolo üö´ y creamos una nueva nota, al enviarla vemos que el navegador realiza solo una petici√≥n al servidor._

![spa send form](./img/26e.png)

_La petici√≥n POST a la direcci√≥n `/new_note_spa` contiene la nueva nota como datos JSON con los campos **content**, que tiene el contenido de la nota, y **date** con la fecha:_

~~~
{
  content: "single page app does not reload the whole page",
  date: "2021-03-30T15:15:59.905Z"
}
~~~

_El header (encabezado) Content-Type de la petici√≥n le dice al servidor que los datos incluidos estan representados con un formato JSON._

![spa request headers](./img/27e.png)

_Sin este encabezado, el servidor podr√≠a no saber c√≥mo analizar (parsear) correctamente los datos._

_El servidor responde con un status code [201 created](https://httpstatuses.com/201), indicando que la nota fue creada correctamente. Esta vez el servidor no le dice al navegador que redireccione y este se mantiene en la misma p√°gina, y no env√≠a mas solicitudes HTTP._

_La versi√≥n SPA de la aplicaci√≥n no envia los datos del formulario de la manera tradicional, sino que utiliza el codigo JavaScript que recuper√≥ del servidor. Miremos un poco este c√≥digo JavaScript, aunque entenderlo al detalle no es importante ahora._

~~~
var form = document.getElementById('notes_form')
form.onsubmit = function(e) {
  e.preventDefault()

  var note = {
    content: e.target.elements[0].value,
    date: new Date(),
  }

  notes.push(note)
  e.target.elements[0].value = ''
  redrawNotes()
  sendToServer(note)
}
~~~

_La instrucci√≥n `document.getElementById('notes_form')` recupera el elemento form que tenia el id `notes_form` y luego le registra un controlador de eventos (event handler) para manejar los eventos del env√≠o de formulario. Este controlador de eventos, que es una funci√≥n, lo primero que hace es llamar al m√©todo `e.preventDefault()`, que es un m√©todo del objeto evento (comunmente nombrado con la letra `e`), que evita el manejo por defecto que tiene el env√≠o del formulario. Este m√©todo por defecto lo que har√≠a es enviar los datos al servidor y causar una nueva solicitud GET que ahora no queremos que pase._

_Luego el controlador de eventos crea una nueva nota en la variable `note` y luego la agrega al array `notes` cone el metodo push con la instrucci√≥n `notes.push(note)`, rerenderizando la lista de notas en la p√°gina con la funci√≥n `redrawNotes()` y enviando la nota al servidor con la funci√≥n `sendToServer(note)`._

_El c√≥digo de la funci√≥n `sendToServer` ser√≠a el siguiente:_

~~~
var sendToServer = function(note) {
  var xhttpForPost = new XMLHttpRequest()
  // ...

  xhttpForPost.open('POST', '/new_note_spa', true)
  xhttpForPost.setRequestHeader(
    'Content-type', 'application/json'
  )
  xhttpForPost.send(JSON.stringify(note))
}
~~~

_El c√≥digo determina que los datos son enviados con una petici√≥n HTTP POST y que el tipo de datos es JSON. Como vimos anteriormente el tipo de datos es indicado en el encabezado `Content-Type`. Luego estos datos son eviados como una cadena de texto tipo JSON convertidos con el m√©todo `JSON.stringify()`._

_El c√≥digo de la aplicaci√≥n esta disponible en `https://github.com/szuviria/app-ejemplo`. Es importante aclarar que **la aplicaci√≥n solo esta destinada solo a demostrar los conceptos del curso**. El c√≥digo sigue un estilo de desarrollo deficiente en cierta medida y debe de usarse de ejemplo al crear sus propias aplicaciones. Lo mismo pasa con las URLs utilizadas. La URL `new_note_spa`, a donde son enviadas las nuevas notas, **no corresponde a buenas pr√°cticas**._



### üîπüîπüîπ Librer√≠as de JavaScript üîπüîπüîπ

_La aplicaci√≥n de ejemplo esta hecha con lo que se llama [vanilla JavaScript](https://medium.freecodecamp.org/is-vanilla-javascript-worth-learning-absolutely-c2c67140ac34), utilizando solo la DOM-API y JavaScript para manipular la estructura de las p√°ginas._

_En lugar de usar JavaScript y la DOM-API solamente, existen diferentes librer√≠as que contienen herramientas que facilitan el trabajo al manipular p√°ginas en comparaci√≥n con la DOM-API. Una de estas librer√≠as que es muy popular es [JQuery](https://jquery.com/)._

_JQuery fue desarrollada cuando las aplicaciones web segu√≠an principalmente el estilo tradicional donde el servidor generaba las p√°ginas HTML, cuya funcionabilidad se mejor√≥ del lado del navegador usando JavaScript escrito con JQuery. Una de las razones del √©xtio de JQuery fue la compatibilidad entre navegadores. La librer√≠a funcionaba independientemente del navegador o de la empresa que lo fabricaba, por lo que no hab√≠a necesidad de soluciones espec√≠ficas para el navegador. Hoy en d√≠a el uso de Jquery no est√° justificado con los avances que tuvo VanillaJS, ya que los navegadores m√°s populares generalmente soportan muy bien las funcionalidades b√°sicas._

_El auge que tuvieron las SPAs trajo formas m√°s "modernas" del desarrollo web que JQuery. La favorita en un principio fue [BackboneJS](http://backbonejs.org/). Luego de su [lanzamiento](https://github.com/angular/angular.js/blob/master/CHANGELOG.md#100-temporal-domination-2012-06-13) en 2012, [AngularJS](https://angularjs.org/) de Google se convirti√≥ rapidamente casi en el estandar de facto del desarrollo web moderno._

_Sin embargo, la popularidad de Angular de desplom√≥ despu√©s de que anunciaran en octubre del 2014 que el soporte para la version 1 se terminar√≠a, y Angular 2 no ser√≠a retrocompatible con la primera versi√≥n. Angular 2 y las versiones m√°s nuevas no han sido bien recibidas._

_Actualmente la herramienta mas populares para implementar la l√≥gica del lado del navegador en el desarrollo de aplicaciones web es la librer√≠a de Facebook, [React](https://reactjs.org/). Durante √©ste curso, trataremos con React y la librer√≠a [Redux](https://github.com/reactjs/redux), que son utilizadas frecuentemente en conjunto._

_El estado de React pare bastante s√≥lido, pero el mundo de JavaScript est√° cambiando constantemente. Por ejemplo, recientemente ha llegado [VueJS](https://vuejs.org/) que ha despertado cierto inter√©s._

### üîπüîπüîπ Desarrollo web full stack üîπüîπüîπ

_Qu√© significa Desarrollo web full stack (Full stack web development)? Full stack es una ppalabra de moda de la que todos hablan pero que nadie sabe muy bien que significa. O al menos, no existe una definici√≥n acordada para el t√©rmino._

_Practicamente todas las aplicaciones web tiene dos "capas": El navegador, que est√° mas cerca del usuario, lo que ser√≠a la capa superior, y la del servidor la inferior. A menudo tambi√©n hay una capa de base de datos debajo del servidor. Por eso, podemos pensar en la arquitectura de una aplicaci√≥n web como una especie de pila (stack) de capas._

_Frecuentemente tambi√©n se habla sobre el [frontend](https://en.wikipedia.org/wiki/Front_and_back_ends) y el [backend](https://en.wikipedia.org/wiki/Front_and_back_ends). El navegador es el frontend, y JavaScript que corre en el navegador es el c√≥digo frontend. El servidor por el otro lado es el backend._

_En el contexto de √©ste curso, el desarrollo web full stack significa que haremos foco en todas las partes de la aplicacion: el frontend,el backend, y la base de datos. A veces, el software en el servidor y su sistema operativo son vista como parte del stack, pero no meteremos ah√≠._

_Escribiremos el c√≥digo del backend con JavaScript, usando el entorno de ejecuci√≥n [Node.js](https://nodejs.org/en/). El uso del mismo lenguaje de programaci√≥n en multiples capas del stack le da al desarrollo web una dimensi√≥n completamente nueva y para qui√©n est√° empezando le facilita mucho las cosas. Sin embargo, no es un requisito del desarrollo web full stack utilizar el mismo lenguaje de programaci√≥n (JavaScript) para todas las capas del stack._

_Lo com√∫n era que los desarrolladores se especializaran en una capa del stack, por ejemplo, el backend. Las tecnolog√≠as en el backend y en el frontend son bastante diferentes. Con esta tendencia Full Stack, se ha vuelto com√∫n que los desarrolladores dominen todas las capas de la aplicaci√≥n y la base de datos. A menudo, los desarrolladores full stack tambien deben tener suficientes habilidades de configuraci√≥n y administraci√≥n para operar su aplicaci√≥n, por ejemplo, en la nube._



